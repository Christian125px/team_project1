Pagina 6 “ Distribuzione giornaliera fatturato 2016 “

( CRITICITÀ SU DICEMBRE 2016 )
Query:
SELECT 
	SUBSTR(o.OrderDate, 1, 4) AS anno, 
	SUBSTR(o.OrderDate, 6, 5) AS meseGiorno, 
	SUM(od.UnitPrice*od.Quantity) AS VenditeGiornaliere 
FROM Orders o 
JOIN "Order Details" od ON o.OrderID = od.OrderID 
WHERE anno = '2016' 
GROUP BY anno, meseGiorno 
ORDER BY anno, meseGiorno;

Pagina 7 “ Distribuzione giornaliera fatturato 2017 ”

( CRITICITÀ possiamo riscontrarla in una certa periodicità dei picchi di revenue (?) verso i giorni centrali dei mesi )
Query:
SELECT 
	SUBSTR(o.OrderDate, 1, 4) AS anno, 
	SUBSTR(o.OrderDate, 6, 5) AS meseGiorno, 
	SUM(od.UnitPrice*od.Quantity) AS VenditeGiornaliere 
FROM Orders o 
JOIN "Order Details" od ON o.OrderID = od.OrderID 
WHERE anno = '2017’ 
GROUP BY anno, meseGiorno 
ORDER BY anno, meseGiorno;

Pagina 8 “ Distribuzione giornaliera fatturato 2018 ”

( CRITICITÀ Incremento quasi del 50% rispetto al massimo presente nel giorno 17-04 )
Query
SELECT 
	SUBSTR(o.OrderDate, 1, 4) AS anno, 
	SUBSTR(o.OrderDate, 6, 5) AS meseGiorno, 
	SUM(od.UnitPrice*od.Quantity) AS VenditeGiornaliere 
FROM Orders o JOIN "Order Details" od ON o.OrderID = od.OrderID 
WHERE anno = '2018’ 
GROUP BY anno, meseGiorno 
ORDER BY anno, meseGiorno

Pagina 10 "Fatturato totale triennale"
( CRITICITÀ I primi 10 paesi detengono la stragrande maggioranza dei record di vendite, con i top 5 che hanno il 62.62% del volume totale )
Query:
SELECT 
       c.Country,
       ROUND(SUM(od.UnitPrice * od.Quantity)) AS CountrySalesAmountRounded
FROM "Order Details" od 
JOIN Orders o ON od.OrderID = o.OrderID 
JOIN Customers c ON c.CustomerID = o.CustomerID 
GROUP BY c.Country
ORDER BY CountrySalesAmountRounded DESC;

Pagina 11 " Uno sguardo ai prodotti "

Query
Top 3 prodotti venduti:
SELECT 
	p.ProductID, 
	p.ProductName, 
	p.CategoryID, 
	c.CategoryName, 
	SUM(od.Quantity) AS Total 
FROM Products p 
JOIN "Order Details" od  ON p.ProductID = od.ProductID
JOIN Categories c ON p.CategoryID = c.CategoryID 
GROUP BY p.ProductID
ORDER BY Total DESC 
LIMIT 3;

Top 3 categorie vendute:
SELECT 
	p.CategoryID, 
	c.CategoryName, 
	SUM(od.Quantity) AS Total 
FROM Products p 
JOIN "Order Details" od  ON p.ProductID = od.ProductID
JOIN Categories c ON p.CategoryID = c.CategoryID 
GROUP BY c.CategoryID 
ORDER BY Total DESC 
LIMIT 3;
