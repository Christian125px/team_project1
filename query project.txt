somma per quantit√† per prodotti

SELECT SUM(od.Quantity) AS totale_prodotti, 
o.ShipCountry
FROM "Order Details" od 
INNER JOIN Orders o 
ON o.OrderID = od.OrderID 
GROUP BY o.ShipCountry 
ORDER BY SUM(od.Quantity) DESC


with total_revenue as ( 
select od.OrderID, SUM (od.UnitPriceod.Quantity) AS total_revenue_per_order
from "Order Details" od
GROUP BY OrderID
)
select ShipCountry, SUM( tr.total_revenue_per_order ) as total_revenue_per_country
from total_revenue tr
join orders o ON o.OrderID = tr.OrderID
GROUP BY ShipCountry 
ORDER BY total_revenue_per_country DESC

-- possiamo inserire qualsiasi data utile, capiamo quali aziende di quali stati hanno effettuato ordini in tale data
-- o range di date

select distinct c.CompanyName, o.ShipCountry
from Customers c
join orders o on c.CustomerID = o.CustomerID
where OrderDate LIKE "2017%" 


-- numero di ordini per paese
select o.ShipCountry, COUNT() as total_orders_country
from Orders o
group by ShipCountry